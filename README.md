# MySQL_basic_practice
[![alt text](https://img.shields.io/badge/mysql-5.6-green.svg)](https://dev.mysql.com/doc/relnotes/mysql/5.6/en/)
![alt text](https://img.shields.io/badge/result-idea%26query__solution-blue.svg)
[![alt text](https://img.shields.io/badge/data-web-red.svg)](https://www.w3resource.com/mysql-exercises/)

> ê¸°ì´ˆì ì¸ Mysql Quizì— ëŒ€í•´ idea, solution, resultë¥¼ ì •ë¦¬í•´ë‘ì—ˆìŠµë‹ˆë‹¤. mysqlì„ remind í•˜ê¸° ìœ„í•´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

> ì–´ë–¤ ë©´ì—ì„œëŠ” ë¬´ì²™ ì‰½ìŠµë‹ˆë‹¤. ì¿¼ë¦¬ë¥¼ ì‚¬ìš© í•  ë•Œ idea, solution, result 3 ë‹¨ê³„ë¥¼ ì°¨ê·¼ì°¨ê·¼ í•´ë³´ê¸° ìœ„í•´ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

> ë¬¸ì œ í’€ì´ ì•„ë˜ì—ëŠ” [www.mysqltutorial.org](http://www.mysqltutorial.org/basic-mysql-tutorial.aspx)ì—ì„œ í•™ìŠµí•˜ë©´ì„œ í•„ìš”í•œ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

### :information_source: DB

mysql 5.6ì„ ì„¤ì¹˜í•˜ì—¬ ì—°ìŠµí•˜ì˜€ìŠµë‹ˆë‹¤.
> mysql ì„¤ì¹˜ëŠ” ê±´ë„ˆë›°ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ì—°ìŠµì— í•„ìš”í•œ DBëŠ” [ì—¬ê¸°ì„œ](https://www.w3resource.com/mysql-exercises//) êµ¬í•˜ì˜€ìŠµë‹ˆë‹¤.
- [HR Database](https://www.w3resource.com/mysql-exercises//db.sql)

### :bookmark: Quiz

Quizë„ ìœ„ì™€ ë™ì¼í•œ í˜ì´ì§€ì—ì„œ êµ¬í•˜ì˜€ìŠµë‹ˆë‹¤.

### ğŸ’¾ File

ë¬¸ì„œ ì‘ì„±ì€ Notionì„ ì´ìš©í•˜ì—¬ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ í›„ HTML íŒŒì¼, Markdown íŒŒì¼ì„ ë°›ì•„ì„œ gitì— ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
> ì—°ìŠµì´ í•„ìš”í•˜ì‹  ë¶„ì€ HTML íŒŒì¼ì„ ë‹¤ìš´ ë°›ì•„ì„œ ë³´ì‹œëŠ” ê±¸ ê¶Œì¥ ë“œë¦½ë‹ˆë‹¤.

### :book: Result

MySQL Basic SELECT statement 19 Exercises
- [html](https://github.com/timetobye/MySQL_basic_practice/tree/master/MySQL%20Basic%20SELECT%20statement%2019%20Exercises)
- [gist](https://gist.github.com/timetobye/e7e8fe3b0b298cc82a8ec456c8b84dec)

MySQL Restricting and Sorting data 11 exercises
- [html](https://github.com/timetobye/MySQL_basic_practice/tree/master/MySQL%20Restricting%20and%20Sorting%20data%20%5B11%20exercises%5D)

Aggregate Functions and Group by 14 exercises
- [html](https://github.com/timetobye/MySQL_basic_practice/tree/master/Aggregate%20Functions%20and%20Group%20by%20%5B14%20exercises%5D)

MySQL Subquery 22 exercises
- [html](https://github.com/timetobye/MySQL_basic_practice/tree/master/MySQL%20Subquery%20%5B22%20exercises%20with%20solution%5D)

MySQL Joins 13 exercises with solution
- [html](https://github.com/timetobye/MySQL_basic_practice/tree/master/MySQL%20Joins%20%5B13%20exercises%20with%20solution%5D)


**thanks to**
- sqlì„ í™œìš©í•´ì„œ ë©‹ì§€ê²Œ ì¼í•˜ì‹œëŠ” ë‚˜ì˜ ë™ë£Œ DDë‹˜ ê°ì‚¬í•©ë‹ˆë‹¤.
- sql ê³ ë¯¼ í•  ë•Œ ì´ê±° ë³´ì„¸ìš” í•˜ê³  ë§í¬ ê±´ë„¤ì£¼ì…¨ë˜ G.S Parkì—ê²Œë„ ê°ì‚¬í•©ë‹ˆë‹¤.
--------------------------


MySQL í•™ìŠµ
--------------------------

# mysql í•™ìŠµ
- mysql í•™ìŠµ í•˜ë©´ì„œ ë°°ìš´ ë‚´ìš©ì„ ì ì–´ ë‘ì—ˆìŠµë‹ˆë‹¤.
- í•™ìŠµ ë§í¬ : [www.mysqltutorial.org](http://www.mysqltutorial.org/basic-mysql-tutorial.aspx)

## mysql ì •ë¦¬
- ëª¨ë¥´ëŠ” ê²ƒ, ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ê²ƒ, ì• ë§¤í•˜ê²Œ ì•Œê³  ìˆëŠ” ê²ƒì„ ì ëŠ”ë‹¤.

### odrer by
- ì•„ë˜ì™€ ê°™ì€ ê²ƒì„ ìƒˆë¡­ê²Œ ë°°ì› ë‹¤.

```
SELECT 
    orderNumber, status
FROM
    orders
ORDER BY FIELD(status,
        'In Process',
        'On Hold',
        'Cancelled',
        'Resolved',
        'Disputed',
        'Shipped');
```

- íŠ¹ì • ì¹¼ëŸ¼ì„ ì§€ì •í•˜ì—¬ ì¹¼ëŸ¼ ë‚´ ê°’ë“¤ì„ ì„ì˜ëŒ€ë¡œ ìˆœì„œ ì¡°ì • í•  ìˆ˜ ìˆë‹¤.
- ì´ë ‡ê²Œ í•˜ë©´ ì •ë ¬ì„ ììœ ìì¬ë¡œ í•  ìˆ˜ ìˆë‹¤.

![Alt text](http://www.mysqltutorial.org/wp-content/uploads/2010/01/MySQL-ORDER-BY-and-FIELD-function.jpg)


### IN VS OR

```
SELECT 
    officeCode, 
    city, 
    phone, 
    country
FROM
    offices
WHERE
    country IN ('USA' , 'France');
```

```
SELECT 
    officeCode, 
    city, 
    phone
FROM
    offices
WHERE
    country = 'USA' OR country = 'France';
```

- In case the list has many values, you need to construct a very long statement with multiple OR operators. Hence, the IN operator allows you to shorten the query and make it more readable.
- ê°€ë…ì„±ì˜ ì¤‘ìš”ì„±

### IN ì—ì„œ subqueryë¥¼ ì‚¬ìš©

```
SELECT 
    orderNumber, 
    customerNumber, 
    status, 
    shippedDate
FROM
    orders
WHERE
    orderNumber IN (SELECT 
            orderNumber
        FROM
            orderdetails
        GROUP BY orderNumber
        HAVING SUM(quantityOrdered * priceEach) > 60000);
```

- êµ¬ë™ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ì€ ì›ë¦¬ë¡œ ì§„í–‰ë˜ì—ˆë‹¤.
```
SELECT 
    orderNumber, 
    customerNumber, 
    status, 
    shippedDate
FROM
    orders
WHERE
    orderNumber IN (10165,10287,10310);
```

### between

- between ì—ì„œ notì€ ì´ë ‡ê²Œ ì‚¬ìš©í•œë‹¤.

```
select 
	productcode,
    productname,
    buyprice
From
	products
where
	buyprice not between 90 and 100;
```

- betweenì€ ê²½ê³„ ê°’ì— ëŒ€í•´ ìƒê°í•´ë³´ê³  ì¨ì•¼ í•œë‹¤.
  - ì˜ˆë¥¼ ë“¤ë©´ ì‹œê°„ ê³„ì‚°, ë‚ ì§œ ê³„ì‚°
  - [Q&A](https://stackoverflow.com/questions/749615/does-ms-sql-servers-between-include-the-range-boundaries/749663)
  

### between with cast

- When you use the BETWEEN operator with date values, to get the best result, you should use the type cast to explicitly convert the type of column or expression to the DATE type.

- For example, to get the orders whose required dates are from 01/01/2003 to 01/31/2003, you use the following query:

```
SELECT 
   orderNumber,
   requiredDate,
   status
FROM 
   orders
WHERE 
   requireddate BETWEEN 
     CAST('2003-01-01' AS DATE) AND 
     CAST('2003-01-31' AS DATE);
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-BEETWEEN-with-Dates-Example.png)

- Because the data type of the required date column is DATE so we used the cast operator to convert the literal strings â€˜2003-01-01 â€˜ and â€˜2003-12-31 â€˜ to the DATE data type.

- **convert the literal strings â€˜2003-01-01 â€˜ and â€˜2003-12-31 â€˜ to the DATE data type.**


### LIKE

```
SELECT 
    employeeNumber, 
    lastName, 
    firstName
FROM
    employees
WHERE
    firstname LIKE 'T_m';
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/mysql-like-with-_-pattern.png)

- 'T_M ì´ë ‡ê²Œ í•˜ë©´ Tom, Tim ë“± ì¼ì¹˜í•˜ëŠ” ë¬¸ìì—´ ê²€ìƒ‰ ê°€ëŠ¥

- not likeë„ ì‚¬ìš© ê°€ëŠ¥
```
select
	employeeNumber,
    lastname,
    firstname
from employees
where lastname not Like 'B%'
```

#### escape in LIKE

- ì›ë˜ '\'ë§Œ ë˜ëŠ” ì¤„ ì•Œì•˜ë‹¤.(ë””í´íŠ¸ ê°’ì´ë‹¤.)
- ê·¸ëŸ°ë° escapeë¥¼ ì§€ì •í•˜ë©´ ê·¸ ë¬¸ìì—´ë„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

- For example, if you want to find product whose product code contains string _20 , you can use the pattern %\_20% as the following query:

```
SELECT 
    productCode, 
    productName
FROM
    products
WHERE
    productCode LIKE '%\_20%';
```

```
SELECT 
    productCode, 
    productName
FROM
    products
WHERE
    productCode LIKE '%$_20%' ESCAPE '$';
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-LIKE-ESCAPE-example.png)


### Nullì— ëŒ€í•œ ì´í•´

```
value IS NULL
```

If the value is NULL, the expression returns true. Otherwise, it returns false.

Note that MySQL does not have the built-in BOOLEAN type. It uses the TINYINT(1) to represent the BOOLEAN values i.e.,  true means 1 and false means 0.

```
SELECT 1 IS NULL,  -- 0
       0 IS NULL,  -- 0
       NULL IS NULL; -- 1
```

```
SELECT 1 IS NOT NULL, -- 1
       0 IS NOT NULL, -- 1
       NULL IS NOT NULL; -- 0
```


- http://www.mysqltutorial.org/mysql-is-null/
  - ìœ„ ë¶€ë¶„ì´ ì´í•´ê°€ ì˜ ë˜ì§€ ì•Šì•˜ë‹¤.
  - ì´í•´ê°€ ë˜ë©´ ì—…ë°ì´íŠ¸ í•  ê²ƒ
  
### exists

- Introduction to MySQL EXISTS operator
The EXISTS operator is a Boolean operator that returns either true or false. The EXISTS operator is often used the in a subquery to test for an â€œexistâ€ condition.

- where, update ë“± ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©
- ì„œë¸Œì¿¼ë¦¬ í•  ë•Œ ë„ ì‚¬ìš©

```
select customernumber, customername
from customers
where
	exists(
    select 1
    from orders
    where orders.customernumber = customers.customernumber);
```
 
 
- sql ì²«ê±¸ìŒ ì±…ì—ì„œë„ ë³¸ ë‚´ìš©ì´ë‹¤. ë‘ ê°œì˜ tableì—ì„œ ê°€ì ¸ì˜¨ ê±¸ ë¹„êµí•  ë•ŒëŠ” table0.column = table1.column

```
SELECT 
    employeenumber, firstname, lastname, extension
FROM
    employees
WHERE
    EXISTS( SELECT 
            1
        FROM
            offices
        WHERE
            city = 'San Francisco'
                AND offices.officeCode = employees.officeCode);
```
  
- select 1 ì€ ì™œ ì“¸ê¹Œ?
  - http://blog.naver.com/PostView.nhn?blogId=aidpost123&logNo=110180721327&parentCategoryNo=9&categoryNo=&viewDate=&isShowPopularPosts=true&from=search

```
Select 1 from table

ìœ„ì²˜ëŸ¼ select ì ˆì— 1ì´ ì˜¤ëŠ” ê²ƒì€ í•´ë‹¹ í…Œì´ë¸”ì˜ ìˆ«ìë§Œí¼ 1ì˜ í–‰ì„ ë§Œë“¤ì–´ ë‚¸ë‹¤.

ì¦‰ table ì˜ ë°ì´í„°ìˆ˜ê°€ Nê°œë©´ 1ì´ Ní–‰ì— ê±°ì³ì„œ ë°˜í™˜ëœë‹¤.

ì´ê²ƒì´ ì¤‘ìš”í•œ ì´ìœ ëŠ” 1ì€ TRUEì˜ ë‹¤ë¥¸ ë§ì´ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ë³´í†µ WHERE ì ˆì˜ (NOT) EXISTS ì•ˆì˜ ë‚´í¬ SELECT ë¬¸ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.

ë˜í•œ SELECT * FROM TABLE ì´ë‚˜ SELECT 1 FROM TABLEì´ë‚˜ ë…¼ë¦¬ì‹ìœ¼ë¡œ ì‚¬ìš©ë  ë•ŒëŠ” ì¡´ì¬ìœ ë¬´ê°€ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì— ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ë©´ SELECT 1 FROM TABLEì„ ì‚¬ìš©í•˜ì§€ë§Œ ì ‘ê·¼ì— ëŒ€í•œ ì •í™•ì„±ì€ ë–¨ì–´ì§ˆ ìˆ˜ ë°–ì— ì—†ë‹¤.
```

- exists ì˜ˆì œëŠ” ì–´ë ¤ì›Œì„œ ë§í¬ë¡œ ëŒ€ì²´í•œë‹¤.
- í•µì‹¬ì€ 1ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì´ Trueì´ë©° ê²°ê³¼ì— ë§¤ì¹­ì‹œí‚¨ë‹¤.
- http://www.mysqltutorial.org/mysql-exists/


#### update in exists

```
update employees
set extension = concat(extension,'1')
where
	exists(
    select 1
    from offices
    where
    city = 'San Francisco'
    and offices.officeCode = employees.officeCode);
```

```
select * from employees
inner join offices on offices.officeCode = employees.officeCode
```

- extensionì´ë¼ëŠ” í•­ëª©ì— 1ì„ ì¶”ê°€ í•´ì•¼ í•˜ëŠ”ë° exitstsë¥¼ ì´ìš©í•˜ì—¬ employeesë¼ëŠ” í•­ëª©ì— 1ì„ ë„£ì—ˆë‹¤.

#### in vs exists

- exists(ì²«ë²ˆì§¸ ê·¸ë¦¼), IN(ë‘ë²ˆì§¸ ê·¸ë¦¼)

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2016/01/MySQL-EXISTS-vs-IN-EXISTS-performance.jpg)

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2016/01/MySQL-EXISTS-vs-IN-IN-performance.jpg)


- í•˜ìœ„ ì¿¼ë¦¬ê°€ ë§ì„ ìˆ˜ë¡ inì´ ëŠë¦¬ë‹¤.
- í’€ìŠ¤ìº”í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- ì ìœ¼ë©´ inì´ ë‚«ë‹¤.
- http://yahwang.tk/posts/35


### order by

- ë¬¸ìì™€ ìˆ«ìê°€ í•¨ê»˜ ì„ì—¬ ìˆëŠ” ê²½ìš°ì˜ ì •ë ¬ì€ ì–´ë–»ê²Œ í•˜ë©´ ì¢‹ì„ê¹Œ?

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2014/01/MySQL-Natural-Sorting-Example.jpg)
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2014/01/MySQL-Natural-Sorting-Example-correct-order.jpg)

- ë‘ë²ˆì¬ ê·¸ë¦¼ì„ ê¸°ëŒ€í•˜ì˜€ë‹¤.

```
SELECT 
    item_no
FROM
    items
ORDER BY CAST(item_no AS UNSIGNED) , item_no;
```
- item_noì˜ ë°ì´í„°ë¥¼ castë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€í˜¸ì—†ëŠ” ì •ìˆ˜ë¡œ ë³€í™˜
- ê·¸ ë‹¤ìŒ ì •ë ¬

```
TRUNCATE TABLE items;
 
INSERT INTO items(item_no)
VALUES('A-1'),
      ('A-2'),
      ('A-3'),
      ('A-4'),
      ('A-5'),
      ('A-10'),
      ('A-11'),
      ('A-20'),
      ('A-30');
```

```
SELECT 
    item_no
FROM
    items
ORDER BY item_no;
```

- truncate í›„ì— ìœ„ì˜ ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ì•ˆ ë‚˜ì˜¨ë‹¤...~~ë­ì•¼..~~

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2014/01/MySQL-Natural-Sorting-Another-Good-Example.jpg)


#### length í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì‘ì—…

- item_noì˜ ë¬¸ìì—´ ê¸¸ì´ë¥¼ ë°˜í™˜í•œ ë‹¤ìŒì— ê¸¸ì´ë³„ë¡œ ì •ë ¬
- ì•„ì´ë””ì–´ì¼ë¿ í•´ê²°ì±…ì€ ì•„ë‹˜

```
SELECT 
    item_no
FROM
    items
ORDER BY LENGTH(item_no), item_no;
```

### limit

#### MySQL LIMITì„ ì‚¬ìš©í•˜ì—¬ n ë²ˆì§¸ë¡œ ë†’ì€ ê°’ ì–»ê¸°

```
SELECT 
    column1, column2,...
FROM
    table
ORDER BY column1 DESC
LIMIT nth-1, count;
```

- offsetì²« ë²ˆì§¸ í–‰ì˜ ì˜¤í”„ì…‹ì„ ì§€ì • ë°˜í™˜í•œë‹¤. offsetì²« ë²ˆì§¸ í–‰ì˜ 0ì´ ì•„ë‹Œ 1ì´ë‹¤.
  - countìµœëŒ€ í–‰ ìˆ˜ë¥¼ ë°˜í™˜í•˜ë„ë¡ ì§€ì •í•©ë‹ˆë‹¤.
  
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2011/03/mysql-limit-offset.jpg)


### inner join

- usingì„ ì‚¬ìš©í•˜ë©´ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.(left, ë§ˆì°¬ê°€ì§€ì´ë‹¤.)
```
SELECT 
    productCode, 
    productName, 
    textDescription
FROM
    products t1
        INNER JOIN
    productlines t2 ON t1.productline = t2.productline;
```
```
SELECT 
    productCode, 
    productName, 
    textDescription
FROM
    products
        INNER JOIN
    productlines USING (productline);
```

### left join

- join ì—ì„œ ì¡°ê±´ì„ ê±¸ìœ¼ë©´ ê²°ê³¼ê°€ ë‹¤ë¥´ê²Œ ë‚˜ì˜¨ë‹¤.
- whereì„ ë”°ë¡œ ê±°ëŠ” ê²½ìš°, left joinì—ì„œ ê±°ëŠ” ê²½ìš°


```
SELECT 
    o.orderNumber, 
    customerNumber, 
    productCode
FROM
    orders o
        LEFT JOIN
    orderDetails USING (orderNumber)
WHERE
    orderNumber = 10123;
```
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2011/05/MySQL-LEFT-JOIN-Condition-in-WHERE-clause.png)

```
SELECT 
    o.orderNumber, 
    customerNumber, 
    productCode
FROM
    orders o
        LEFT JOIN
    orderdetails d ON o.orderNumber = d.orderNumber
        AND o.orderNumber = 10123;
```
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2011/05/MySQL-LEFT-JOIN-Condition-in-ON-clause.png)

### group by, having

- 2018-03-03ì´ë¼ëŠ” ë°ì´í„°ê°€ ìˆì„ ë•Œ Year, Month, dayë¥¼ ì“°ë©´ ë…„, ì›”, ì¼ì„ ì¶”ì¶œí•  ìˆ˜ ìˆë”ë¼.

```
SELECT 
    YEAR(orderDate) AS year,
    SUM(quantityOrdered * priceEach) AS total
FROM
    orders
        INNER JOIN
    orderdetails USING (orderNumber)
WHERE
    status = 'Shipped'
GROUP BY YEAR(orderDate);
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2011/05/MySQL-GROUP-BY-expression-example.png)

```
SELECT 
    YEAR(orderDate) AS year,
    SUM(quantityOrdered * priceEach) AS total
FROM
    orders
        INNER JOIN
    orderdetails USING (orderNumber)
WHERE
    status = 'Shipped'
GROUP BY YEAR
having year > 2003;
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2011/05/MySQL-GROUP-BY-with-HAVING-example.png)


- group by ì—ì„œë„ ì •ë ¬ì„ í•  ìˆ˜ ìˆë‹¤.

```
SELECT 
    status, COUNT(*)
FROM
    orders
GROUP BY status DESC;
```

- havingì„ ì“°ëŠ” ì˜ˆë¥¼ ë” ì ì–´ë³´ì•˜ë‹¤.

```
SELECT 
    ordernumber,
    SUM(quantityOrdered) AS itemsCount,
    SUM(priceeach*quantityOrdered) AS total
FROM
    orderdetails
GROUP BY ordernumber
HAVING total > 1000 AND itemsCount > 600;
```

```
SELECT 
    a.ordernumber, status, SUM(priceeach*quantityOrdered) total
FROM
    orderdetails a
        INNER JOIN
    orders b ON b.ordernumber = a.ordernumber
GROUP BY ordernumber, status
HAVING status = 'Shipped' AND total > 1500;
```

### Rollup

- http://www.mysqltutorial.org/mysql-rollup/
- ê¸°ë³¸ì„œì— ë‚˜ì˜¤ì§€ ì•Šì€ ë‚´ìš©ì´ë‹¤.
- group by ê²°ê³¼ê°€ ìˆì„ ë•Œ ê·¸ ê°’ì˜ ì´í•©ì„ êµ¬í•˜ëŠ” ê²ƒê¹Œì§€ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
  - í•©ì‚° ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” table ë§Œë“¤ì–´ì„œ union all?
  - ê·¸ëŸ¬ë©´...
  - The query is quite lengthy.
  - The performance of the query may not be good since the database engine has to internally execute two separate queries and combine the result sets into one.
  
```
SELECT 
    select_list
FROM 
    table_name
GROUP BY
    c1, c2, c3 WITH ROLLUP;
```

```
SELECT 
    productLine, 
    SUM(orderValue) totalOrderValue
FROM
    sales
GROUP BY 
    productline WITH ROLLUP;
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2018/08/MySQL-ROLLUP-example.png)

- the ROLLUP clause generates not only the subtotals but also the grand total of the order values.
- ~~ì˜¤ì˜·....ì§±ì´ë‹¤~~

```
SELECT 
    productLine, 
    orderYear,
    SUM(orderValue) totalOrderValue
FROM
    sales
GROUP BY 
    productline, 
    orderYear 
WITH ROLLUP;
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2018/08/MySQL-ROLLUP-hierarchy.png)

- mysql 8.0.12 ë²„ì „ì—ì„œëŠ” ë” ì¢‹ì€ ê¸°ëŠ¥ì´ ìˆìœ¼ë‚˜ ì„¤ì¹˜ ì•ˆ í•´ì„œ íŒ¨ìŠ¤(rollup ë§í¬ ì°¸ì¡°)


### DEFAULT CHARSET=utf8

- local DBì— csv íŒŒì¼ì„ ë„£ì„ ë•Œ í•œê¸€ì´ ê¹¨ì§€ëŠ” ê²½ìš°ê°€ ë°œìƒí•œë‹¤.
- ê·¸ëŸ´ ë•Œ ìƒì„±í•˜ëŠ” tableì— ëª…ë ¹ì–´ë¥¼ ì¶”ê°€í•˜ë©´ ì‰½ê²Œ ë¬¸ì œë¥¼ í•´ê²° í•  ìˆ˜ ìˆë‹¤.

```
create table 'DB name'.'table name' (
'table_name_1' INT(11) unsigned NOT NULL COMMENT 'hihihihi',
'table_name_2' INT(11) unsigned NOT NULL COMMENT 'hihihihi',
'table_name_3' VARCHAR(255) NOT NULL COMMENT 'hihihihi'
) DEFAULT CHARSET=utf8
```

- í•œê¸€ì´ ì˜ ë“¤ì–´ê°€ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.


### now(), sysdate(), current_date()

- ì¿¼ë¦¬ë¥¼ ë§Œë“¤ ë•Œ í˜„ì¬ ë‚ ì§œì™€ ê´€ë ¨í•˜ì—¬ ì–´ë–¤ ê²ƒì„ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?
- ë‚ ì§œë§Œ í•„ìš”í•˜ë©´ current_date(), ì¿¼ë¦¬ ë‚ ë¦¬ëŠ” ì‹œê°ì˜ ë³€í™”ê°€ ë¶ˆí•„ìš”í•˜ë©´ now(), ê°™ì€ ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ëŠ” ì¤‘ì—ë„ ë³€í™”ê°€ ìˆìœ¼ë©´ sysdate()

```
mysql> select now(), sysdate(), current_date(), sleep(5), now(), sysdate();
+---------------------+---------------------+----------------+----------+---------------------+---------------------+
| now()               | sysdate()           | current_date() | sleep(5) | now()               | sysdate()           |
+---------------------+---------------------+----------------+----------+---------------------+---------------------+
| 2019-05-21 03:11:57 | 2019-05-21 03:11:57 | 2019-05-21     |        0 | 2019-05-21 03:11:57 | 2019-05-21 03:12:02 |
+---------------------+---------------------+----------------+----------+---------------------+---------------------+
1 row in set (5.02 sec)
```

- [ì°¸ê³  í˜ì´ì§€](https://stackoverflow.com/questions/24137752/difference-between-now-sysdate-current-date-in-mysql)



### concat_ws vs concat

- concat_wsì™€ concatì˜ ì°¨ì´ë¥¼ ì•„ë˜ì™€ ê°™ë‹¤.
- concat_wsì— ë¬¸ìì—´ì„ ì§€ì •í•˜ë©´ ë‘ê°œì˜ ë¬¸ìì—´ì„ í•©ì¹˜ë©´ì„œ ê·¸ ì‚¬ì´ì— ì§€ì •ëœ ë¬¸ìì—´ì´ ë“¤ì–´ê°„ë‹¤.

```
select concat_ws(', ', last_name, first_name) as full_name
from employees
limit 100;

#,full_name
1,"Facello, Georgi"
2,"Simmel, Bezalel"
3,"Bamford, Parto"
4,"Koblick, Chirstian"
5,"Maliniak, Kyoichi"
6,"Preusig, Anneke"
7,"Zielinski, Tzvetan"
8,"Kalloufi, Saniya"
9,"Peac, Sumant"
```
- ê·¸ë ‡ë‹¤ë©´ 3ê°œì˜ columnì´ ì§€ì •ë˜ë©´...?
```
select concat_ws(', ', last_name, first_name, last_name) as full_name
from employees
limit 100;

#,full_name
1,"Facello, Georgi, Facello"
2,"Simmel, Bezalel, Simmel"
3,"Bamford, Parto, Bamford"
4,"Koblick, Chirstian, Koblick"
5,"Maliniak, Kyoichi, Maliniak"
6,"Preusig, Anneke, Preusig"
7,"Zielinski, Tzvetan, Zielinski"
8,"Kalloufi, Saniya, Kalloufi"
9,"Peac, Sumant, Peac"
```
- ìœ„ì— ì²˜ëŸ¼ ì²˜ìŒì— ì§€ì •ëœ ë¬¸ìê°€ êµ¬ë¶„ìê°€ ëœë‹¤.

- concatì€ í•˜ë‚˜í•˜ë‚˜ì”© ë‹¤ ì§€ì •ì„ í•´ì¤˜ì•¼ í•œë‹¤.
```
select concat(last_name, ', ',first_name) as full_name
from employees
limit 100

#,full_name
1,"Facello, Georgi"
2,"Simmel, Bezalel"
3,"Bamford, Parto"
4,"Koblick, Chirstian"
5,"Maliniak, Kyoichi"
6,"Preusig, Anneke"
7,"Zielinski, Tzvetan"
8,"Kalloufi, Saniya"
9,"Peac, Sumant"
```

### group_concat
- group byë¥¼ ì‘ìš©
- grouping ë˜ëŠ” í•­ëª©ê³¼ ê´€ë ¨ëœ ë‹¤ë¥¸ ê°’ë“¤ì„ concatí•´ì„œ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.
- êµ¬ë¶„ìë¥¼ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ',' ê°€, ì„¤ì •í•  ê²½ìš° ì˜ˆì œì—ëŠ” '-'ê°€ í‘œì‹œë˜ì—ˆë‹¤.

```
select productline, group_concat(distinct productScale)
from products
group by productLine


#,productline,group_concat(distinct productScale)
1,Classic Cars,"1:10,1:12,1:18,1:24"
2,Motorcycles,"1:10,1:12,1:18,1:24,1:32,1:50"
3,Planes,"1:18,1:72,1:24,1:700"
4,Ships,"1:18,1:24,1:700,1:72"
5,Trains,"1:18,1:32,1:50"
6,Trucks and Buses,"1:12,1:18,1:24,1:32,1:50"
7,Vintage Cars,"1:18,1:24,1:32,1:50"


select productline, group_concat(distinct productScale separator'-')
from products
group by productLine

#,productline,group_concat(distinct productScale separator'-')
1,Classic Cars,1:10-1:12-1:18-1:24
2,Motorcycles,1:10-1:12-1:18-1:24-1:32-1:50
3,Planes,1:18-1:72-1:24-1:700
4,Ships,1:18-1:24-1:700-1:72
5,Trains,1:18-1:32-1:50
6,Trucks and Buses,1:12-1:18-1:24-1:32-1:50
7,Vintage Cars,1:18-1:24-1:32-1:50
```


### IFNULL

- MySQL IFNULL function is one of the MySQL control flow functions that accepts two arguments and returns the first argument if it is not NULL. Otherwise, the IFNULL function returns the second argument.
```
IFNULL(expression_1,expression_2);
```
- The IFNULL function returns expression_1 if expression_1 is not NULL ; otherwise, it returns expression_2.

```
select ifnull(1, 0);

result : 1
```

```
select ifnull('', 1);

result : ë¹ˆì¹¸ ë‚˜ì˜´ = ''
```

```
select ifnull(null, 'IFNULL_FUNCTION');

result : 'IFNULL_FUNCTION'
```


### Derived table

- A derived table is a virtual table returned from a SELECT statement. A derived table is similar to a temporary table, but using a derived table in the SELECT statement is much simpler than a temporary table because it does not require steps of creating the temporary table.

- The term **derived table** and subquery is often used interchangeably. When a stand-alone subquery is used in the FROM clause of a SELECT statement, we call it a derived table.

- The following illustrates a query that uses a derived table:

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2017/07/MySQL-Derived-Table.png)  

```
SELECT 
    customerNumber,
    ROUND(SUM(quantityOrdered * priceEach)) sales,
    (CASE
        WHEN SUM(quantityOrdered * priceEach) < 10000 THEN 'Silver'
        WHEN SUM(quantityOrdered * priceEach) BETWEEN 10000 AND 100000 THEN 'Gold'
        WHEN SUM(quantityOrdered * priceEach) > 100000 THEN 'Platinum'
    END) customerGroup
FROM
    orderdetails
        INNER JOIN
    orders USING (orderNumber)
WHERE
    YEAR(shippedDate) = 2003
GROUP BY customerNumber;
```

```
SELECT 
    customerGroup, 
    COUNT(cg.customerGroup) AS groupCount
FROM
    (SELECT 
        customerNumber,
            ROUND(SUM(quantityOrdered * priceEach)) sales,
            (CASE
                WHEN SUM(quantityOrdered * priceEach) < 10000 THEN 'Silver'
                WHEN SUM(quantityOrdered * priceEach) BETWEEN 10000 AND 100000 THEN 'Gold'
                WHEN SUM(quantityOrdered * priceEach) > 100000 THEN 'Platinum'
            END) customerGroup
    FROM
        orderdetails
    INNER JOIN orders USING (orderNumber)
    WHERE
        YEAR(shippedDate) = 2003
    GROUP BY customerNumber) cg
GROUP BY cg.customerGroup;   
```

- result
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2017/07/MySQL-Derived-Table-Customer-Group-Counts.png)


### MySQL CTE
mysql 8.0ë¶€í„° ì§€ì› ê°€ëŠ¥í•œ ê¸°ëŠ¥ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ê¸°ëŠ¥ì€ redshiftë¥¼ ì‚¬ìš©í•  ë•Œ ì¢…ì¢… ì‚¬ìš©í–ˆë˜ ê¸°ë²•ìœ¼ë¡œ ì•Œë©´ ì°¸ ì¢‹ì€ ê¸°ëŠ¥ì´ë‹¤. í˜„ì¬ 5.6ìœ¼ë¡œ í•™ìŠµì„ í•˜ê³  ìˆëŠ”ë° ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ì¢‹ì•„ì„œ ë‚¨ê¸´ë‹¤.
```
MySQL introduced the common table expression feature or CTE in short since version 8.0 so you should have MySQL 8.0 installed on your computer in order to practice with the statements in this tutorial.
```

```
WITH customers_in_usa AS (
    SELECT 
        customerName, state
    FROM
        customers
    WHERE
        country = 'USA'
) SELECT 
    customerName
 FROM
    customers_in_usa
 WHERE
    state = 'CA'
 ORDER BY customerName;
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2017/07/MySQL-CTE-Example-1.png)


### recursive CTE
- ë‚˜ì¤‘ì— í•™ìŠµ í•  ë‚´ìš©
- http://www.mysqltutorial.org/mysql-recursive-cte/


###

```
WITH topsales2003 AS (
    SELECT 
        salesRepEmployeeNumber employeeNumber,
        SUM(quantityOrdered * priceEach) sales
    FROM
        orders
            INNER JOIN
        orderdetails USING (orderNumber)
            INNER JOIN
        customers USING (customerNumber)
    WHERE
        YEAR(shippedDate) = 2003
            AND status = 'Shipped'
    GROUP BY salesRepEmployeeNumber
    ORDER BY sales DESC
    LIMIT 5
)
SELECT 
    employeeNumber, firstName, lastName, sales
FROM
    employees
        JOIN
    topsales2003 USING (employeeNumber);
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2017/07/MySQL-CTE-Example-2.png)


### Union vs Union All

**Union**

Unionì„ í•˜ê²Œ ë˜ë©´ ì»¬ëŸ¼ì´ ê°™ì€ ë‘ ê°œì˜ í…Œì´ë¸”ì„ ê²°í•© í•  ìˆ˜ ìˆë‹¤. ë‹¨ ì¤‘ë³µë˜ëŠ” í•­ëª©ì€ ì§€ì›Œì§„ë‹¤.

**Union All**

Union Allì„ í•˜ê²Œ ë˜ë©´ ë§ˆì°¬ê°€ì§€ë¡œ ì»¬ëŸ¼ì´ ê°™ì€ ë‘ ê°œì˜ í…Œì´ë¸”ì„ ê²°í•© í•  ìˆ˜ ìˆë‹¤. ë‹¨ ì¤‘ë³µë˜ëŠ” í•­ëª©ì€ ì§€ì›Œì§€ì§€ ì•ŠëŠ”ë‹¤.
-  the duplicates appear in the combined result set because of the UNION ALL operation.

```
SELECT id
FROM t1
UNION
SELECT id
FROM t2;

+----+
| id |
+----+
|  1 |
|  2 |
|  3 |
|  4 |
+----+


SELECT id
FROM t1
UNION ALL
SELECT id
FROM t2;

+----+
| id |
+----+
|  1 |
|  2 |
|  3 |
|  2 |
|  3 |
|  4 |
+----+
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-UNION.png)
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-UNION-vs-JOIN.png)

ê·¸ë ‡ë‹¤ë©´ ë‹¤ë¥¸ joiní‚¤ê°€ ì—†ëŠ” ë‹¤ë¥¸ í…Œì´ë¸”ì€ ì–´ë–»ê²Œ ê²°í•© í•  ìˆ˜ ìˆì„ê¹Œ?

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2013/02/employees_table.png)

```
SELECT 
    firstName, 
    lastName
FROM
    employees 
UNION 
SELECT 
    contactFirstName, 
    contactLastName
FROM
    customers;
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-UNION-example.png)


### INTERSECT

basic concept
```
(SELECT column_list 
FROM table_1)
INTERSECT
(SELECT column_list
FROM table_2);
```

To use the INTERSECT operator for two queries, the following rules are applied:
- The order and the number of columns must be the same.
- The data types of the corresponding columns must be compatible.

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2014/05/MySQL-INTERSECT.png)

**but** Unfortunately, MySQL does not support the INTERSECT operator. However, you can simulate the INTERSECT operator.

```
SELECT id
FROM t1;

id
----
1
2
3

SELECT id
FROM t2;

id
---
2
3
4
```

Simulate MySQL INTERSECT operator using DISTINCT operator and INNER JOIN clause.
- The following statement uses DISTINCT operator and INNER JOIN clause to return the distinct rows in both tables:

```
SELECT DISTINCT 
   id 
FROM t1
   INNER JOIN t2 USING(id);
   
id
----
2
3


ELECT DISTINCT
    id
FROM
    t1
WHERE
    id IN (SELECT 
            id
        FROM
            t2);
	    
id
----
2
3
```


### Minus
basic concept
```
SELECT column_list_1 FROM table_1
MINUS 
SELECT columns_list_2 FROM table_2;
```
- MYSQLì—ì„œëŠ” Minus ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ...? LEFT joinì„ ì‘ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2017/07/MySQL-MINUS.png)


```
SELECT 
    column_list 
FROM 
    table_1
    LEFT JOIN table_2 ON join_predicate
WHERE 
    table_2.id IS NULL; 
```

```
SELECT 
    id
FROM
    t1
        LEFT JOIN
    t2 USING (id)
WHERE
    t2.id IS NULL;
```

### Insert
The INSERT statement allows you to insert one or more rows into a table. The following illustrates the syntax of the INSERT statement

basice concept
```
INSERT INTO table(c1,c2,...)
VALUES (v1,v2,...);


INSERT INTO table(c1,c2,...)
VALUES 
   (v11,v12,...),
   (v21,v22,...),
    ...
   (vnn,vn2,...);
```

ref : http://www.mysqltutorial.org/mysql-insert-statement.aspx


### Insert into select

basic concept

```
INSERT INTO table_name(column_list)
SELECT 
   select_list 
FROM 
   another_table;
```

ì•„ë˜ì™€ ê°™ì€ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤ê³  í•˜ì.

```
CREATE TABLE suppliers (
    supplierNumber INT AUTO_INCREMENT,
    supplierName VARCHAR(50) NOT NULL,
    phone VARCHAR(50),
    addressLine1 VARCHAR(50),
    addressLine2 VARCHAR(50),
    city VARCHAR(50),
    state VARCHAR(50),
    postalCode VARCHAR(50),
    country VARCHAR(50),
    customerNumber INT
    PRIMARY KEY (supplierNumber)
);
```


```
SELECT 
    customerNumber,
    customerName,
    phone,
    addressLine1,
    addressLine2,
    city,
    state,
    postalCode,
    country
FROM
    customers
WHERE
    country = 'USA' AND 
    state = 'CA';
```

![alt text](http://www.mysqltutorial.org/wp-content/uploads/2018/09/MySQL-INSERT-INTO-SELECT-customers-data-to-be-inserted.png)

ìƒˆë¡­ê²Œ ìƒì„±í•œ í…Œì´ë¸”ì— ì•„ë˜ì˜ ì¿¼ë¦¬ë¬¸ì„ ë„£ìœ¼ë©´...!!
```
INSERT INTO suppliers (
    supplierName, 
    phone, 
    addressLine1,
    addressLine2,
    city,
    state,
    postalCode,
    country,
    customerNumber
)
SELECT 
    customerName,
    phone,
    addressLine1,
    addressLine2,
    city,
    state ,
    postalCode,
    country,
    customerNumber
FROM 
    customers
WHERE 
    country = 'USA' AND 
    state = 'CA';
    
SELECT 
    *
FROM
    suppliers;
```

ì´ë ‡ê²Œ ëœë‹¤.
![alt text](http://www.mysqltutorial.org/wp-content/uploads/2018/09/MySQL-INSERT-INTO-SELECT-Example.png)

### IF
- MySQL IF function is one of the MySQL control flow functions that returns a value based on a condition. The IF function is sometimes referred to as IF ELSE or IF THEN ELSE function.

```
IF(expr,if_true_expr,if_false_expr)
```

- If the expr evaluates to TRUE i.e., expr is not NULL and expr is not 0, the IF function returns the if_true_expr , otherwise, it returns if_false_expr The IF function returns a numeric or a string, depending on how it is used.

```
SELECT IF(1 = 2,'true','false'); -- false

SELECT IF(1 = 1,' true','false'); -- true
```

```
SELECT
    customerNumber, customerName, state, country
FROM
    customers;
    
#,customerNumber,customerName,state,country
1,103,Atelier graphique,,France
2,112,Signal Gift Stores,NV,USA
3,114,"Australian Collectors, Co.",Victoria,Australia
4,119,La Rochelle Gifts,,France
5,121,Baane Mini Imports,,Norway
6,124,Mini Gifts Distributors Ltd.,CA,USA
7,125,Havel & Zbyszek Co,,Poland



SELECT
    customerNumber,
    customerName,
    if(state is Null,'N/A', state),
    country
FROM
    customers;

#,customerNumber,customerName,"if(state is Null,'N/A', state)",country
1,103,Atelier graphique,N/A,France
2,112,Signal Gift Stores,NV,USA
3,114,"Australian Collectors, Co.",Victoria,Australia
4,119,La Rochelle Gifts,N/A,France
5,121,Baane Mini Imports,N/A,Norway
6,124,Mini Gifts Distributors Ltd.,CA,USA
7,125,Havel & Zbyszek Co,N/A,Poland
```

MySQL IF function with aggregate functions
- MySQL SUM IF â€“ Combining the IF function with the SUM function
- The IF function is useful when it combines with an aggregate function. Suppose if you want to know how many orders have been shipped and cancelled, you can use the IF function with the SUM aggregate function as the following query:

```
select
    sum(if(status = 'Shipped', 1, 0)) AS shipped,
    sum(if(status = 'Cancelled', 1, 0)) AS Cancelled
from
    orders;

#,shipped,Cancelled
1,303,6
```

MySQL COUNT IF â€“ Combining the IF function with the COUNT function

```
SELECT DISTINCT
    status
FROM
    orders
ORDER BY status;

#,status
1,Cancelled
2,Disputed
3,In Process
4,On Hold
5,Resolved
6,Shipped


SELECT 
    COUNT(IF(status = 'Cancelled', 1, NULL)) Cancelled,
    COUNT(IF(status = 'Disputed', 1, NULL)) Disputed,
    COUNT(IF(status = 'In Process', 1, NULL)) 'In Process',
    COUNT(IF(status = 'On Hold', 1, NULL)) 'On Hold',
    COUNT(IF(status = 'Resolved', 1, NULL)) 'Resolved',
    COUNT(IF(status = 'Shipped', 1, NULL)) 'Shipped'
FROM
    orders;
    
#,Cancelled,Disputed,In Process,On Hold,Resolved,Shipped
1,6,3,6,4,4,303 
```

ê°™ì€ ê²°ê³¼ë¡œ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš© í•  ìˆ˜ë„ ìˆë‹¤.
```
SELECT status, COUNT(STATUS)
FROM orders
GROUP BY status
```
- ê°€ë¡œë¡œ ë³´ì—¬ì£¼ëŠëƒ,...ì„¸ë¡œë¡œ ë³´ì—¬ì£¼ëŠëƒ...



### Update
- use the UPDATE statement to update existing data in a table. you can also use the UPDATE statement to change column values of a single row, a group of rows, or all rows in a table.

```
UPDATE [LOW_PRIORITY] [IGNORE] table_name 
SET 
    column_name1 = expr1,
    column_name2 = expr2,
    ...
[WHERE
    condition];
```

- First, specify the table name that you want to update data after the UPDATE keyword.
- Second, the SET clause specifies which column that you want to modify and the new values. To update multiple columns, you use a list of comma-separated assignments. You supply a value in each columnâ€™s assignment in the form of a literal value, an expression, or a subquery.
- Third, specify which rows to be updated using a condition in the WHERE clause. The WHERE clause is optional. If you omit the WHERE clause, the UPDATE statement will update all rows in the table.


**LOW_PRIORITY**, **IGNORE**
- The LOW_PRIORITY modifier instructs the UPDATE statement to delay the update until there is no connection reading data from the table. The LOW_PRIORITY takes effect for the storage engines that use table-level locking only, for example, MyISAM, MERGE, MEMORY.
- The IGNORE modifier enables the UPDATE statement to continue updating rows even if errors occurred. The rows that cause errors such as duplicate-key conflicts are not updated.


```
SELECT 
    firstname, lastname, email
FROM
    employees
WHERE
    employeeNumber = 1056;
    
#	firstname	lastname	email
1	Mary	Patterson	mpatterso@classicmodelcars.com


update employees
set email = 'mary.patterson@classicmodelcars.com'
where employeeNumber = 1056;


SELECT 
    firstname, lastname, email
FROM
    employees
WHERE
    employeeNumber = 1056;

#	firstname	lastname	email
1	Mary	Patterson	mary.patterson@classicmodelcars.com
```

```
UPDATE employees 
SET 
    lastname = 'Hill',
    email = 'mary.hill@classicmodelcars.com'
WHERE
    employeeNumber = 1056;
    

SELECT
    firstname, lastname, email
FROM
    employees
WHERE
    employeeNumber = 1056;


#	firstname	lastname	email
1	Mary	Hill	mary.hill@classicmodelcars.com
```

```
SELECT 
    customername, salesRepEmployeeNumber
FROM
    customers
WHERE
    salesRepEmployeeNumber IS NULL;


#	customername	salesRepEmployeeNumber
1	Havel & Zbyszek Co	
2	Porto Imports Co.	
3	Asian Shopping Network, Co	
4	NatÃ¼rlich Autos	
5	ANG Resellers	
6	Messner Shopping Network



UPDATE customers 
SET 
    salesRepEmployeeNumber = (SELECT 
            employeeNumber
        FROM
            employees
        WHERE
            jobtitle = 'Sales Rep'
        LIMIT 1)
WHERE
    salesRepEmployeeNumber IS NULL;
    
    
SELECT
     salesRepEmployeeNumber
FROM
    customers
WHERE
    salesRepEmployeeNumber IS NOT NULL;
    
    #	salesRepEmployeeNumber
1	1165
2	1165
3	1165
4	1165
5	1165
6	1165
7	1165
8	1165
9	1165
10	1165
11	1165
.....
```




---------------------------------------------------------------


### Date Function

#### CURDATE
- The CURDATE() function returns the current date as a value in the 'YYYY-MM-DD' format if it is used in a string context or YYYMMDD format if it is used in a numeric context.

shows how the CURDATE() function is used in the string context.
```
select curdate();

2019-08-16
```

illustrates how the CURDATE() function is used in a numeric context
```
select curdate() + 0;

20190816
```

The CURRENT_DATE and CURRENT_DATE() are synonyms for CURDATE().
```
select current_date(), current_date, curdate()

#	current_date()	current_date	curdate()
1	2019-08-16	2019-08-16	2019-08-16
```

CURDATE vs. NOW
- The CURDATE() function returns the current date with date part only while the NOW() function returns both date and time parts of the current time.

```
select current_date, now()

#	current_date	now()
1	2019-08-16	2019-08-16 17:14:14


select date(now());

2019-08-16
```


#### DATEDIFF
- The MySQL DATEDIFF function calculates the number of days between two  DATE,  DATETIME, or  TIMESTAMP values.
- http://www.mysqltutorial.org/mysql-datediff.aspx

basic concept
```
DATEDIFF(date_expression_1,date_expression_2);
```

```
SELECT DATEDIFF('2011-08-17','2011-08-17'); --  0 day
0

SELECT DATEDIFF('2011-08-17','2011-08-08'); --  9 days
9

SELECT DATEDIFF('2011-08-08','2011-08-17'); -- -9 days
-9
```

```
SELECT 
    orderNumber, 
    DATEDIFF(requiredDate, shippedDate) daysLeft
FROM
    orders
ORDER BY daysLeft DESC;

#	orderNumber	daysleft
1	10409	11
2	10410	10
3	10105	9
4	10135	9
5	10190	9
6	10201	9
7	10254	9
8	10257	9
9	10289	9
10	10299	9
11	10302	9


SELECT
    orderNumber,
    DATEDIFF(requiredDate, orderDate) remaining_days
FROM
    orders
WHERE
    status = 'In Process'
ORDER BY remaining_days;

#	orderNumber	remaining_days
1	10423	6
2	10425	7
3	10421	8
4	10424	8
5	10420	9
6	10422	12


SELECT 
    orderNumber,
    ROUND(DATEDIFF(requiredDate, orderDate) / 7, 2),
    ROUND(DATEDIFF(requiredDate, orderDate) / 30,2)
FROM
    orders
WHERE
    status = 'In Process';
    
#	orderNumber	ROUND(DATEDIFF(requiredDate, orderDate) / 7, 2)	ROUND(DATEDIFF(requiredDate, orderDate) / 30,2)
1	10420	1.29	0.30
2	10421	1.14	0.27
3	10422	1.71	0.40
4	10423	0.86	0.20
5	10424	1.14	0.27
6	10425	1.00	0.23    
```

#### DAY

```
DAY(date)

SELECT DAY('2010-01-15');

15

ì‘ìš©í•˜ë©´....


SELECT 
    DAY(orderdate) dayofmonth, 
    COUNT(*)
FROM
    orders
WHERE
    YEAR(orderdate) = 2004
GROUP BY dayofmonth
ORDER BY dayofmonth;

#	dayofmonth	COUNT(*)
1	1	5
2	2	9
3	3	7
4	4	8
5	5	6
6	6	3
7	7	4
8	8	4
9	9	7
10	10	7
11	11	3
12	12	5
13	13	3
...
```

#### DATE_ADD
- http://www.mysqltutorial.org/mysql-date_add/
- The DATE_ADD function adds an interval to a DATE or DATETIME value. The following illustrates the syntax of the DATE_ADD function

```
DATE_ADD(start_date, INTERVAL expr unit);
```

The DATE_ADD function may return a DATETIME value or a string, depending on the arguments:
- ì²˜ìŒì— ì…ë ¥ë˜ëŠ” í˜•ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.
- DATETIME if the first argument is a DATETIME value or if the interval value has time element such as hour, minute or second, etc.
- String otherwise.

```
SELECT 
    DATE_ADD('1999-12-31 23:59:59',
        INTERVAL 1 SECOND) result;
 
+---------------------+
| result              |
+---------------------+
| 2000-01-01 00:00:00 |
+---------------------+
1 row in set (0.00 sec)
```

```
SELECT 
    DATE_ADD('1999-12-31 00:00:01',
        INTERVAL 1 DAY) result;        
 
+---------------------+
| result              |
+---------------------+
| 2000-01-01 00:00:01 |
+---------------------+
1 row in set (0.00 sec)
```

- ë©€í‹°íƒ€ì…ìœ¼ë¡œ ì…ë ¥ë„ ë˜ëŠ” ë“¯ minute_second
```
SELECT 
    DATE_ADD('1999-12-31 23:59:59',
        INTERVAL '1:1' MINUTE_SECOND) result;
 
+---------------------+
| result              |
+---------------------+
| 2000-01-01 00:01:00 |
+---------------------+
1 row in set (0.00 sec)
```

```
SELECT DATE_ADD('2000-01-01 00:00:00',
     INTERVAL '-1 5' DAY_HOUR) result;
 
+---------------------+
| result              |
+---------------------+
| 1999-12-30 19:00:00 |
+---------------------+
1 row in set (0.00 sec)
```

**interval handling**

```
SELECT 
    DATE_ADD('2000-01-01',
        INTERVAL 5 / 2 HOUR_MINUTE) result;
 
 
+---------------------+
| result              |
+---------------------+
| 2000-01-04 13:20:00 |
+---------------------+
1 row in set (0.00 sec)
```

```
SELECT 
    DATE_ADD('2010-01-30', 
              INTERVAL 1 MONTH) result;
 
+------------+
| result     |
+------------+
| 2010-02-28 |
+------------+
1 row in set (0.00 sec)
```
#### DATE_SUB
- http://www.mysqltutorial.org/mysql-date_sub/
- ê²°ë¡ ì ìœ¼ë¡œëŠ” ì‚¬ìš©ë²• ìì²´ëŠ” DATE_ADDë‘ ë‹¤ë¥¼ê²Œ ì—†ëŠ”ë“¯
- The DATE_SUB() function subtracts a time value (or an interval) from a DATE or DATETIME value. The following illustrates the DATE_SUB() function:

```
DATE_SUB(start_date,INTERVAL expr unit)
```

The DATE_SUB() function accepts two arguments:
- start_date is the starting DATE or DATETIME value.
- expr is a string that determines an interval value to be subtracted from the starting date. The unit is the interval unit that expr should be interpreted e.g., DAY, HOUR, etc.

```
SELECT DATE_SUB('2017-07-04',INTERVAL 1 DAY) result;
+------------+
| result     |
+------------+
| 2017-07-03 |
+------------+
1 row in set (0.00 sec) 
```

#### DATE_FORMAT
- To format a date value to a specific format, you use the DATE_FORMAT function. The syntax of the DATE_FORMAT function is as follows:

```
DATE_FORMAT(date,format)
```

The DATE_FORMAT function accepts two arguments:
- date : is a valid date value that you want to format
- format : is a format string that consists of predefined specifiers. Each specifier is preceded by a percentage character ( % ). See the table below for a list of predefined specifiers.
- ê²°êµ­ %ê°€ ìˆëŠ” ë¶€ë¶„ì„ ì˜ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”ë°....ë„ˆë¬´ ë§ì•„ì„œ ë§í¬ë¥¼ ê±¸ì–´ë†“ê³  ìì£¼ ë³´ì.
- http://www.mysqltutorial.org/mysql-date_format/

```
SELECT 
    orderNumber,
    DATE_FORMAT(orderdate, '%Y-%m-%d') orderDate,
    DATE_FORMAT(requireddate, '%a %D %b %Y') requireddate,
    DATE_FORMAT(shippedDate, '%W %D %M %Y') shippedDate
FROM
    orders;
    
    #	orderNumber	orderDate	requireddate	shippedDate
1	10100	2003-01-06	Mon 13th Jan 2003	Friday 10th January 2003
2	10101	2003-01-09	Sat 18th Jan 2003	Saturday 11th January 2003
3	10102	2003-01-10	Sat 18th Jan 2003	Tuesday 14th January 2003
4	10103	2003-01-29	Fri 7th Feb 2003	Sunday 2nd February 2003
5	10104	2003-01-31	Sun 9th Feb 2003	Saturday 1st February 2003
6	10105	2003-02-11	Fri 21st Feb 2003	Wednesday 12th February 2003
7	10106	2003-02-17	Mon 24th Feb 2003	Friday 21st February 2003
....
```

#### STR_TO_DATE()
- http://www.mysqltutorial.org/mysql-str_to_date/
- The STR_TO_DATE() converts the str string into a date value based on the fmt format string. The STR_TO_DATE() function may return a DATE , TIME, or DATETIME value based on the input and format strings. If the input string is illegal, the STR_TO_DATE() function returns NULL.
- ì¿¼ë¦¬ í•  ë•Œ ì¢…ì¢… í•„ìš”í•˜ë”ë¼...
```
STR_TO_DATE(str,fmt);
```

```
SELECT STR_TO_DATE('21,5,2013','%d,%m,%Y');

2013-05-21
```

Based on the format string â€˜%d, %m, %Yâ€™, the STR_TO_DATE() function scans the â€˜21,5,2013â€™ input string.
- First, it attempts to find a match for the %d format specifier, which is a day of the month (01â€¦31), in the input string. Because the number 21 matches with the %d specifier, the function takes 21 as the day value.
- Second, because the comma (,) literal character in the format string matches with the comma in the input string, the function continues to check the second format specifier %m , which is a month (01â€¦12), and finds that the number 5 matches with the %m format specifier. It takes the number 5 as the month value.
- Third, after matching the second comma (,), the STR_TO_DATE() function keeps finding a match for the third format specifier %Y , which is four-digit year e.g., 2012,2013, etc., and it takes the number 2013 as the year value.

Point!!
- The STR_TO_DATE() function ignores extra characters at the end of the input string when it parses the input string based on the format string. See the following example:

```
SELECT STR_TO_DATE('21,5,2013 extra characters','%d,%m,%Y');

2013-05-21
```

ë¶ˆì™„ì „í•œ ê°’ì´ ë“¤ì–´ì˜¤ë©´...
- The STR_TO_DATE() sets all incomplete date values, which are not provided by the input string, to zero. See the following example:
```
SELECT STR_TO_DATE('2013','%Y');

2012-11-30


SELECT STR_TO_DATE('113005','%h%i%s');

11:30:05
```
